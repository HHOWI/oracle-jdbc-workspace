DROP TABLE USER_INFO;
DROP TABLE USER_PROFILE;
DROP TABLE BLOCK_USERS;
DROP TABLE BAN_INFO;
DROP TABLE USER_LIKE;
DROP TABLE LIKE_INFO;

-- 유저 정보
CREATE TABLE USER_INFO(
    USER_ID VARCHAR2(50),       -- 유저 아이디
    USER_PWD VARCHAR2(50) NOT NULL,     -- 유저 패스워드
    USER_NAME VARCHAR2(30) NOT NULL,        -- 유저 이름
    USER_NICKNAME VARCHAR2(50) UNIQUE NOT NULL,     -- 유저 닉네임
    USER_SUBSCRIPTION DATE DEFAULT SYSDATE NOT NULL,        -- 가입날짜
    USER_ADDMIN CHAR DEFAULT 'N' NOT NULL CHECK(USER_ADDMIN IN ('Y', 'N'))      -- 관리자 권한 유무    
);

CREATE TABLE USER_PROFILE(
    USER_NAME VARCHAR2(50),     -- 유저 이름
    AGE NUMBER,     -- 나이
    GENDER CHAR NOT NULL CHECK(GENDER IN ('남', '여')),       -- 성별
    PLACE VARCHAR2(300) NOT NULL,       -- 활동지역
    PHONE VARCHAR2(20) NOT NULL,        -- 전화번호
    PROFILE_IMG VARCHAR2(500),      -- 프로필 이미지
    STATUS_MESSAGE VARCHAR2(1000),      -- 상태 메세지
    LOVER CHAR CHECK(LOVER IN ('Y', 'N')),      -- 애인 유무
    BLOOD_TYPE VARCHAR2(5) CHECK(BLOOD_TYPE IN ('A', 'B', 'AB', 'O')),      -- 혈액형
    MBTI VARCHAR2(8),       -- MBTI
    BIRTHDAY DATE       -- 생일
);

CREATE TABLE BLOCK_USERS( -- 유저 차단
    BLOCK_USER_SEQ NUMBER,     -- 유저 차단 SEQ
    USER_ID VARCHAR2(50) NOT NULL,  -- 유저 ID
    BLOCK_ID VARCHAR2(50) NOT NULL,     -- 차단 유저 ID
    BLOCK_DATE DATE DEFAULT SYSDATE NOT NULL,    -- 차단 일자 
    BLOCK_REASON VARCHAR2(100),     -- 차단 이유
    UNBLOCK CHAR DEFAULT 'N' NOT NULL CHECK(UNBLOCK IN ('Y', 'N'))  -- 차단 해제
);

CREATE TABLE BAN_INFO(  -- 유저 정지
    BAN_INFO_SEQ NUMBER,    -- 정지 정보 SEQ
    BAN_ID VARCHAR2(50) NOT NULL,   -- 정지 ID
    BAN_START DATE DEFAULT SYSDATE NOT NULL,    -- 정지 시작 날짜
    BAN_END DATE NOT NULL,      -- 정지 차단 날짜
    BAN_REASON VARCHAR2(1000) NOT NULL      -- 정지 이유
);

CREATE TABLE USER_LIKE( -- 유저 좋아요
    LIKE_UP_SEQ NUMBER,     --  좋아요 SEQ
    LIKE_UP_DATE DATE DEFAULT SYSDATE NOT NULL,     -- 좋아요 누른 날짜
    LIKE_UP_USER VARCHAR(50) NOT NULL,      -- 좋아요를 눌러준 ID
    LIKE_UP_TARGET_SEQ NUMBER   -- 좋아요를 눌려진 ID
);

CREATE TABLE LIKE_INFO( -- 좋아요 정보
    LIKE_UP_TAGET_SEQ NUMBER,   -- 좋아요 누른 SEQ
    LIKE_UP_TAGET_USER VARCHAR(50) NOT NULL     -- 좋아요 눌려진 ID
);

ALTER TABLE USER_INFO ADD CONSTRAINT USER_ID_PK PRIMARY KEY(USER_ID);               
ALTER TABLE USER_PROFILE ADD CONSTRAINT USER_PROFILE_PK PRIMARY KEY(USER_NAME);     
ALTER TABLE BLOCK_USERS ADD CONSTRAINT BLOCK_USERS_PK PRIMARY KEY(BLOCK_USER_SEQ);
ALTER TABLE BAN_INFO ADD CONSTRAINT BAN_INFO_PK PRIMARY KEY(BAN_INFO_SEQ);
ALTER TABLE USER_LIKE ADD CONSTRAINT USER_LIKE_PK PRIMARY KEY(LIKE_UP_SEQ);
ALTER TABLE LIKE_INFO ADD CONSTRAINT LIKE_INFO_PK PRIMARY KEY(LIKE_UP_TAGET_SEQ);

ALTER TABLE USER_INFO ADD CONSTRAINT USER_NAME_FK FOREIGN KEY(USER_NAME) REFERENCES USER_PROFILE(USER_NAME);
ALTER TABLE BLOCK_USERS ADD CONSTRAINT USER_ID_FK FOREIGN KEY(USER_ID) REFERENCES USER_INFO (USER_ID);
ALTER TABLE BLOCK_USERS ADD CONSTRAINT USER_ID_FK2 FOREIGN KEY(BLOCK_ID) REFERENCES USER_INFO (USER_ID);
ALTER TABLE BAN_INFO ADD CONSTRAINT USER_ID_FK3 FOREIGN KEY(BAN_ID) REFERENCES USER_INFO(USER_ID);
ALTER TABLE USER_LIKE ADD CONSTRAINT USER_ID_FK4 FOREIGN KEY(LIKE_UP_USER) REFERENCES USER_INFO(USER_ID);
ALTER TABLE LIKE_INFO ADD CONSTRAINT USER_ID_FK5 FOREIGN KEY(LIKE_UP_TAGET_USER) REFERENCES USER_INFO(USER_ID);

CREATE SEQUENCE SEQ_BLOCK_USERS;
CREATE SEQUENCE SEQ_BAN_INFO;
CREATE SEQUENCE SEQ_USER_LIKE; 
CREATE SEQUENCE SEQ_LIKE_INFO;
